<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Nam Nguyen">
<meta name="description" content="Security analysis of a D-Link IoT device" />
<meta name="keywords" content="homepage, blog, tech, engineering, portfolio, cybersecurity, embedded systems, electronics, IoT, security, reverse engineering" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://namberino.github.io/posts/2025/05/iot-security-analysis-d-link-dir-820l-router/" />


    <title>
        
            IoT Security Analysis: D-Link DIR-820L Router :: Nam&#39;s Journal 
        
    </title>





  <link rel="stylesheet" href="/main.min.244183cde1a38e0b08f82c11791181288f9aac1cc9618cd6f4e9e7710c5768ba.css" integrity="sha256-JEGDzeGjjgsI&#43;CwReRGBKI&#43;arBzJYYzW9OnncQxXaLo=" crossorigin="anonymous">





    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">



  <meta itemprop="name" content="IoT Security Analysis: D-Link DIR-820L Router">
  <meta itemprop="description" content="Security analysis of a D-Link IoT device">
  <meta itemprop="datePublished" content="2025-05-31T15:22:55+07:00">
  <meta itemprop="dateModified" content="2025-05-31T15:22:55+07:00">
  <meta itemprop="wordCount" content="1771">
  <meta itemprop="image" content="https://namberino.github.io/">
  <meta itemprop="keywords" content="IoT,Security,Reverse Engineering">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://namberino.github.io/">
  <meta name="twitter:title" content="IoT Security Analysis: D-Link DIR-820L Router">
  <meta name="twitter:description" content="Security analysis of a D-Link IoT device">



    <meta property="og:url" content="https://namberino.github.io/posts/2025/05/iot-security-analysis-d-link-dir-820l-router/">
  <meta property="og:site_name" content="Nam&#39;s Journal">
  <meta property="og:title" content="IoT Security Analysis: D-Link DIR-820L Router">
  <meta property="og:description" content="Security analysis of a D-Link IoT device">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-05-31T15:22:55+07:00">
    <meta property="article:modified_time" content="2025-05-31T15:22:55+07:00">
    <meta property="article:tag" content="IoT">
    <meta property="article:tag" content="Security">
    <meta property="article:tag" content="Reverse Engineering">
    <meta property="og:image" content="https://namberino.github.io/">






    <meta property="article:published_time" content="2025-05-31 15:22:55 &#43;0700 &#43;07" />













<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false}
            ]
        });
    });
</script>

    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text ">
                nam@journal</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about/">About</a></li><li><a href="/posts/">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
                <span class="theme-toggle not-selectable" style="margin-left: 1.5rem; margin-right: 1rem;">
    
        
            
            <a class="active language" style="text-decoration: underline;"> EN </a>
            
                <div style="margin-left: 0.12rem; margin-right: 0.12rem;"> | </div>
            
        
    
        
            
                <a href="https://namberino.github.io/vi/posts/2025/05/ph%C3%A2n-t%C3%ADch-b%E1%BA%A3o-m%E1%BA%ADt-iot-router-d-link-dir-820l/" style="text-decoration: none;"> VI </a>
            
        
    

</span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        9 minutes

         | Also available in
          
              <a href="https://namberino.github.io/vi/posts/2025/05/ph%C3%A2n-t%C3%ADch-b%E1%BA%A3o-m%E1%BA%ADt-iot-router-d-link-dir-820l/"><span class="flag fi fi-"></span></a>
          
        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://namberino.github.io/posts/2025/05/iot-security-analysis-d-link-dir-820l-router/">IoT Security Analysis: D-Link DIR-820L Router</a>
      </h1>

      
        <div class="post-excerpt">Security analysis of a D-Link IoT device</div>
      

      
        <hr />
        <aside id="toc">
          <div class="toc-title">Table of Contents</div>
          <nav id="TableOfContents">
  <ul>
    <li><a href="#the-importance-of-iot-security">The importance of IoT security</a></li>
    <li><a href="#lab-environment">Lab environment</a>
      <ul>
        <li><a href="#binwalk">Binwalk</a></li>
        <li><a href="#sasquatch">Sasquatch</a></li>
        <li><a href="#qemu">QEMU</a></li>
        <li><a href="#firmae">FirmAE</a></li>
        <li><a href="#firmware-mod-kit">Firmware mod kit</a></li>
        <li><a href="#ghidra">Ghidra</a></li>
        <li><a href="#burp-suite">Burp Suite</a></li>
      </ul>
    </li>
    <li><a href="#firmware-analysis">Firmware analysis</a></li>
    <li><a href="#exploits">Exploits</a>
      <ul>
        <li><a href="#command-injection-in-ping-diagnostic">Command injection in ping diagnostic</a></li>
        <li><a href="#stack-overflow-dos-in-cancel-ping">Stack overflow DoS in cancel ping</a></li>
        <li><a href="#firmware-modification">Firmware modification</a></li>
        <li><a href="#insecure-access-control-in-password-change">Insecure access control in password change</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
        </aside>
        <hr />

      

      <div class="post-content">
        <h2 id="the-importance-of-iot-security">The importance of IoT security</h2>

    <img src="/img/dir820l-security/iot-growth-graph.png"  alt="IoT Growth Graph"  class="center"  style="padding: 10px"  />


<p>The number of IoT devices in the world has been growing significantly. As more and more devices come online, the more security risks there is. And as we all know, the &ldquo;S&rdquo; in &ldquo;IoT&rdquo; stands for Security.</p>
<p>The need for security in the IoT sector is growing along with the growth of IoT. Security within IoT is important as there&rsquo;s much bigger consequences if a critical IoT device is hacked compared to a website being hacked. If some IoT devices that&rsquo;s being used for critical purposes such as health monitoring or ICS operation, compromise of such systems could lead to devastating physical consequences. In the worst case, it could endanger human life.</p>
<p>In this blog post, I&rsquo;ll be diving into IoT security analysis. I&rsquo;ll work on the <a href="https://legacy.us.dlink.com/pages/product.aspx?id=00c2150966b046b58ba95d8ae3a8f73d">D-Link DIR-820L</a> router. Their firmware is available <a href="https://legacyfiles.us.dlink.com/DIR-820L/REVA/FIRMWARE/DIR-820L_REVA_FIRMWARE_1.06B02.ZIP">here</a>.</p>
<h2 id="lab-environment">Lab environment</h2>
<p>I&rsquo;m analyzing this firmware in Ubuntu 18.04. Here are the tools I&rsquo;ll use.</p>
<ul>
<li><a href="https://github.com/ReFirmLabs/binwalk">Binwalk</a></li>
<li><a href="https://github.com/devttys0/sasquatch">Sasquatch</a></li>
<li><a href="https://github.com/qemu/qemu">QEMU</a></li>
<li><a href="https://github.com/pr0v3rbs/FirmAE">FirmAE</a></li>
<li><a href="https://github.com/rampageX/firmware-mod-kit">Firmware mod kit</a></li>
<li><a href="https://github.com/NationalSecurityAgency/ghidra">Ghidra</a></li>
<li><a href="https://portswigger.net/burp">Burp Suite</a></li>
</ul>
<h3 id="binwalk">Binwalk</h3>
<p><code>binwalk</code> is used to analyze the firmware and identify the embedded files and file systems within the firmware. It allows us to locate partitions and archives, analyze the entropy of the file, and extract the segments.</p>
<h3 id="sasquatch">Sasquatch</h3>
<p><code>sasquatch</code> is used for unpacking a SquashFS file system. This is basically an improved version of <code>unsquashfs</code>.</p>
<h3 id="qemu">QEMU</h3>
<p>A full-system emulator and virtualizer that supports a wide range of different hardware architectures. It offers multi-architecture emulation, which is useful for embedded devices, which mostly uses ARM-based or MIPS-based architectures. It also offers networking configurations and debugging support.</p>
<h3 id="firmae">FirmAE</h3>
<p>This is a framework that streamlines end-to-end IoT firmware analysis. It automates firmware extraction and unpacking (by utilizing tools like <code>binwalk</code> and <code>sasquatch</code>). It uses heuristics to get CPU architecture for QEMU, which has been pre-configured. It also setup networking which allows us to access the device&rsquo;s web interface without actually owning the device.</p>
<h3 id="firmware-mod-kit">Firmware mod kit</h3>
<p>This tool extracts the underlying file system in the firmware, which allows for modification. This tool can also rebuild the modified firmware into a binary file.</p>
<h3 id="ghidra">Ghidra</h3>
<p><code>ghidra</code> is a reverse engineering framework with support for multiple different architectures such as x86_64, ARM, MIPS, etc.</p>
<h3 id="burp-suite">Burp Suite</h3>
<p>This is a web security analyzer. It contains many different features that allows analysis of HTTP requests.</p>
<h2 id="firmware-analysis">Firmware analysis</h2>
<p>Binwalk analysis shows a hidden SquashFS file system in the firmware. There&rsquo;s also extra LZMA compressed data inside the firmware too. The SquashFS file system is commonly used on embedded devices. It&rsquo;s mostly used for the root partition as having it read-only ensure the device can&rsquo;t easily brick itself.</p>

    <img src="/img/dir820l-security/dir820l-binwalk-results.png"  alt="Binwalk result"  class="center"  style="padding: 10px"  />


<p>Using the extraction feature of binwalk, we can extract the underlying SquashFS file system.</p>

    <img src="/img/dir820l-security/dir820l-squashfs-file-system.png"  alt="SquashFS file system"  class="center"  style="padding: 10px"  />


<p>The <code>shadow</code> file contains the password hash of the root user. Running this through <code>john</code> gives us the root password, which is <code>root</code>, very insecure.</p>

    <img src="/img/dir820l-security/dir820l-shadow-cracked.png"  alt="Cracked root password"  class="center"  style="padding: 10px"  />


<p>A quick analysis of the <code>rcS</code> startup file shows that the firmware will initialize <code>bulkListen</code> and <code>ncc2</code> when it starts up. The <code>ncc2</code> service is used for processing <a href="https://en.wikipedia.org/wiki/Common_Gateway_Interface">Common Gateway Interface (CGI)</a> requests. CGI is an interface specification that enables web servers to execute external programs to process HTTP and HTTPS requests. We can find the <code>ncc2</code> binary in <code>/sbin</code>.</p>

    <img src="/img/dir820l-security/dir820l-ncc2-sbin.png"  alt="sbin/ncc2 file"  class="center"  style="padding: 10px"  />


<p>We can also learn that the firmware runs on a 32-bit MIPSEB architecture. Originally I was planning to use IDA for reverse engineering but since IDA Pro is required for analysis of any architecture that isn&rsquo;t x86_64, I opted for Ghidra, which is open source and has support for the MIPS architecture.</p>
<p>Running this binary through <code>checksec</code> also shows that this binary doesn&rsquo;t have contain any overflow protection mechanism. It also doesn&rsquo;t contain any debugging symbols, which means it has been stripped, which will make the reverse engineering process a bit harder.</p>

    <img src="/img/dir820l-security/checksec-ncc2.png"  alt="ncc2 checksec"  class="center"  style="padding: 10px"  />


<h2 id="exploits">Exploits</h2>
<p>I&rsquo;ll cover 4 different exploits for this device.</p>
<h3 id="command-injection-in-ping-diagnostic">Command injection in ping diagnostic</h3>
<p>This vulnerability has been identified in the <code>ncc2</code> service (<code>/sbin/ncc2</code>) of the D-Link DIR-820L. Within the <code>ncc2</code> service, there&rsquo;s a functionality called <code>ping.ccp</code>, which allows for performing &ldquo;ping&rdquo; diagnostics.</p>

    <img src="/img/dir820l-security/dir-ncc2-ping-check-screen.png"  alt="ping check screen"  class="center"  style="padding: 10px"  />


<p>Captured request in Burp Suite:</p>

    <img src="/img/dir820l-security/dir-ping-check-burp-suite.png"  alt="ping check request in burp suite"  class="center"  style="padding: 10px"  />


<p>The function <code>FUN_0049e128</code> is responsible for processing POST requests to <code>ping.ccp</code>. This function gets the ping address through the request&rsquo;s <code>ping_addr</code> variable.</p>

    <img src="/img/dir820l-security/cve-2024-51186-request-processing.png"  alt="ping request handler"  class="center"  style="padding: 10px"  />


<p>The ping address is ran through the <code>hasInjectionString</code> function, which was imported from <code>libleopard.so</code>. This function checks for the existence of the following 4 characters: &ldquo;`&rdquo;, &ldquo;\&rdquo;, &ldquo;;&rdquo;, &ldquo;&rsquo;&rdquo;, &ldquo;|&rdquo;. If any of these characters are found in the user input, the request won&rsquo;t be processed.</p>

    <img src="/img/dir820l-security/hasinjectionstring-function.png"  alt="hasInjectionString function"  class="center"  style="padding: 10px"  />


<p>This <code>hasInjectionString</code> function did not check for all possible command separators. It is possible to inject a command through the use of the newline character <code>\n</code> or <code>0x0A</code> in hex.</p>
<p>We can test the command injection by trying to send a GET request to our HTTP server through the router.</p>

    <img src="/img/dir820l-security/command-injection-dir-ping-cgi-wget-test.png"  alt="CMDi ping cgi wget test"  class="center"  style="padding: 10px"  />


<p>This works. Now, we can construct an exploit. We can use telnet to create a bind shell using this command.</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>telnetd -l /bin/sh -p <span style="color:#d19a66">9999</span> -b 0.0.0.0
</span></span></code></pre></div>
    <img src="/img/dir820l-security/command-injection-dir-ping-cgi-telnet-bind-shell.png"  alt="CMDi ping cgi telnet bind shell"  class="center"  style="padding: 10px"  />


<p>To mitigate this vulnerability, the <code>hasInjectionString</code> function black list needs to include more command separation characters.</p>
<h3 id="stack-overflow-dos-in-cancel-ping">Stack overflow DoS in cancel ping</h3>
<p>The function <code>FUN_0049e5b0</code> contains a stack overflow. When the function copies the string from the parameter <code>nextPage</code> to <code>acStack_118</code>, it uses <code>strcpy</code> and doesn&rsquo;t check the length of the string.</p>

    <img src="/img/dir820l-security/ping-ccp-cancel-ping-function.png"  alt="ping ccp cancel ping handler"  class="center"  style="padding: 10px"  />


<p>We can test for a buffer overflow DoS by entering a string over 256 characters long. I tested this and found that we need a string with a minimum of 288 characters to successfully DoS the router&rsquo;s <code>ncc2</code> service.</p>

    <img src="/img/dir820l-security/cancelPing-overflow-test.png"  alt="cancelPing overflow test"  class="center"  style="padding: 10px"  />


<p>To mitigate this, <code>FUN_0049e5b0</code> needs to implement some string length check or use <code>strncpy</code> for copying strings.</p>
<h3 id="firmware-modification">Firmware modification</h3>
<p>An exploit that can be performed if you have access to the physical device is a firmware modification attack. To do this, an attacker need to extract the firmware of the device, unpack the firmware, modify it, then flash the modified firmware on the device. Because the DIR-820L&rsquo;s firmware is available online, we can download it and modify it then flash it on a device later on.</p>
<p>Using Firmware Mod Kit, we can extract the firmware&rsquo;s SquashFS file system into <code>fmk/rootfs</code>.</p>

    <img src="/img/dir820l-security/fmk-rootfs-dir820l.png"  alt="fmk/rootfs of firmware"  class="center"  style="padding: 10px"  />


<p>Now, we can modify the <code>rcS</code> script in <code>/etc/init.d</code>, which is used to run additional programs at boot time as specified in <code>/etc/inittab</code>. We can modify this file with malicious instructions and execute malicious programs. I&rsquo;ll make it open up a telnet service on port 9999 for now.</p>

    <img src="/img/dir820l-security/dir820l-rcs-modification-telnet.png"  alt="rcS modification with telnet"  class="center"  style="padding: 10px"  />


<p>Now, we can build this firmware into a <code>bin</code> file.</p>

    <img src="/img/dir820l-security/dir820-build-new-firmware.png"  alt="modified firmware building"  class="center"  style="padding: 10px"  />


<p>With the new firmware, we can now flash the firmware onto the router. D-Link DIR routers allow for <a href="http://forums.dlink.com/index.php?topic=44909.0">emergency flash</a>. Since I don&rsquo;t have the device, I&rsquo;ll simulate the modified firmware instead.</p>

    <img src="/img/dir820l-security/dir820l-modified-fw-telnet.png"  alt="modified firmware telnet connection"  class="center"  style="padding: 10px"  />


<p>This is the <code>nmap</code> scan of the original, unmodified firmware.</p>

    <img src="/img/dir820l-security/dir820l-nmap-scan-orig-fw.png"  alt="nmap scan original firmware"  class="center"  style="padding: 10px"  />


<p>This is the <code>nmap</code> scan of the modified firmware. Port 9999 has been opened.</p>

    <img src="/img/dir820l-security/dir820l-nmap-scan-new-fw.png"  alt="nmap scan modified firmware"  class="center"  style="padding: 10px"  />


<p>This would only work if the attacker is in the same network as the router. To connect remotely over the Internet, we can insert a backdoor program which can open up a reverse shell to our server.</p>
<p><code>netcat</code> can be used for this. Unfortunately, the <code>busybox</code> that we have on the firmware doesn&rsquo;t have <code>netcat</code>. So we need to import a MIPSEB <code>busybox</code> that has <code>netcat</code> into the firmware and use that to create a reverse shell. I used this <a href="https://busybox.net/downloads/binaries/1.21.1/busybox-mips"><code>busybox</code></a> binary.</p>
<p>I imported the new <code>busybox</code> binary into the <code>/bin</code> directory and gave it executable permission. Now we can call this <code>busybox</code> to use <code>netcat</code>.</p>
<p>I made this very simple reverse shell script and stored it in <code>/bin</code>. It will check for Internet connection and will only open up a reverse shell if there&rsquo;s an Internet connection. If there is an Internet connection, it will try to establish a <code>netcat</code> connection to port 4444 or the specified IP address with <code>/bin/sh</code> as the exec file. I&rsquo;m using my LAN address here as I don&rsquo;t have a server.</p>

    <img src="/img/dir820l-security/dir820l-backdoor-script.png"  alt="backdoor script"  class="center"  style="padding: 10px"  />


<p>Now, when we try to emulate this firmware and get <code>netcat</code> to listen on port 4444 on our system, we can see that the backdoor works.</p>

    <img src="/img/dir820l-security/dir820l-backdoor-connection.png"  alt="backdoor connection"  class="center"  style="padding: 10px"  />


<p>To prevent this attack, the firmware can be encrypted to prevent reverse engineering and unpacking and incorporate TPM (Trusted Platform Module), which provides hardware-based encryption and decryption. The device could also use secure boot with a digitally signed firmware.</p>
<h3 id="insecure-access-control-in-password-change">Insecure access control in password change</h3>
<p>DIR-820L suffers from insecure access control in the admin account change password functionality of the router. Function <code>FUN_00451208</code> has been identified as the function responsible for accepting the CGI request for setting information.</p>

    <img src="/img/dir820l-security/ccp-act-set-conditional.png"  alt="ccp_act set conditional"  class="center"  style="padding: 10px"  />


<p>By default, the password is read from the file <code>defaultCfg.txt</code> stored in <code>sbin</code>. When the firmware is loaded and executed, the content of the default configuration files are then copied into <code>/var/tmp/cfg.txt</code>. Any modification to the configuration done by the admin will be applied to this <code>cfg.txt</code> file.</p>

    <img src="/img/dir820l-security/default-cfg-file-load-function.png"  alt="default cfg file load function"  class="center"  style="padding: 10px"  />


<p>The <code>ncc2</code> program does not perform any validation. This leads to insecure access control. An attacker could craft a packet to the <code>get_set.ccp</code> CGI handler without knowing the old password and still be able to change the password of the admin account. The <code>pure_SetDeviceSettings</code> function is most likely responsible for handling the admin password change functionality.</p>

    <img src="/img/dir820l-security/set-device-settings-function.png"  alt="set device settings function"  class="center"  style="padding: 10px"  />


<p>This function will use <code>sendEvent</code> to modify the configuration file in <code>/var/tmp</code>. Case 0 of <code>param_1</code> will call the <code>ncc_save_rtcfg</code> function.</p>

    <img src="/img/dir820l-security/send-event-load-rtcfg.png"  alt="sendEvent load rtcfg"  class="center"  style="padding: 10px"  />


<p>I could no find any method for checking for old password referenced within <code>ncc2</code>. Additionally, there&rsquo;s no user session validation in <code>ncc2</code> and the only cookie in the administration website is a binary cookie called <code>hasLogin</code>, no user session cookie. So it is safe to assume there is no user validation or old password validation in the password change functionality. Therefore, we can capture the request to change the password and modify the request to change the password. This request can be launched against other routers remotely.</p>

    <img src="/img/dir820l-security/password-get-set-ccp-request.png"  alt="password get_set.ccp request"  class="center"  style="padding: 10px"  />


<p>Sending this request to the router will change the router&rsquo;s configuration file to whatever the request specified. We can check the configuration file read in FirmAE&rsquo;s debug mode.</p>

    <img src="/img/dir820l-security/var-tmp-cfg-grep-login.png"  alt="grep /var/tmp/cfg.txt for login information"  class="center"  style="padding: 10px"  />


<p>To mitigate this, the devices needs to implement user session, which would prevent attackers from making unauthenticated requests. Currently, the device only sets a <code>hasLogin</code> binary cookie, which is not sufficient for user session validation. Additionally, the device needs to prompt the user for the old password before allowing them to change the password.</p>
<h2 id="conclusion">Conclusion</h2>
<p>IoT devices are in desperate need of better security. A compromised IoT device could lead to information disclosure in the best case, and death in the worst case. It is imperative that IoT security gets more attention as the consequences could be devastating.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://www.mdpi.com/1999-5903/17/1/19">IoT Firmware Emulation and Its Security Application in Fuzzing: A Critical Revisit</a></li>
<li><a href="https://syssec.kaist.ac.kr/pub/2020/kim_acsac2020.pdf">FirmAE: Towards Large-Scale Emulation of IoT Firmware for Dynamic Analysis</a></li>
<li><a href="https://code.google.com/archive/p/firmware-mod-kit/wikis/Documentation.wiki">firmware-mod-kit Documentation</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-51186">CVE-2024-51186</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-25281">CVE-2023-25281</a></li>
<li><a href="https://en.wikipedia.org/wiki/Blended_threat">Blended threat</a></li>
</ul>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://namberino.github.io/tags/iot/">IoT</a></span>
        <span class="tag"><a href="https://namberino.github.io/tags/security/">security</a></span>
        <span class="tag"><a href="https://namberino.github.io/tags/reverse-engineering/">reverse engineering</a></span>
        
    </p>

      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        1771 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2025-05-31 15:22
        

         
          
        
      </p>
    </div>
      <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fnamberino.github.io%2fposts%2f2025%2f05%2fiot-security-analysis-d-link-dir-820l-router%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fnamberino.github.io%2fposts%2f2025%2f05%2fiot-security-analysis-d-link-dir-820l-router%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=IoT%20Security%20Analysis%3a%20D-Link%20DIR-820L%20Router&amp;caption=IoT%20Security%20Analysis%3a%20D-Link%20DIR-820L%20Router&amp;canonicalUrl=https%3a%2f%2fnamberino.github.io%2fposts%2f2025%2f05%2fiot-security-analysis-d-link-dir-820l-router%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=IoT%20Security%20Analysis%3a%20D-Link%20DIR-820L%20Router&amp;body=https%3a%2f%2fnamberino.github.io%2fposts%2f2025%2f05%2fiot-security-analysis-d-link-dir-820l-router%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fnamberino.github.io%2fposts%2f2025%2f05%2fiot-security-analysis-d-link-dir-820l-router%2f&amp;media=https%3a%2f%2fnamberino.github.io%2fposts%2f2025%2f05%2fiot-security-analysis-d-link-dir-820l-router%2f;description=IoT%20Security%20Analysis%3a%20D-Link%20DIR-820L%20Router" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fnamberino.github.io%2fposts%2f2025%2f05%2fiot-security-analysis-d-link-dir-820l-router%2f&amp;title=IoT%20Security%20Analysis%3a%20D-Link%20DIR-820L%20Router&amp;summary=IoT%20Security%20Analysis%3a%20D-Link%20DIR-820L%20Router&amp;source=https%3a%2f%2fnamberino.github.io%2fposts%2f2025%2f05%2fiot-security-analysis-d-link-dir-820l-router%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2fnamberino.github.io%2fposts%2f2025%2f05%2fiot-security-analysis-d-link-dir-820l-router%2f&amp;resubmit=true&amp;title=IoT%20Security%20Analysis%3a%20D-Link%20DIR-820L%20Router" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2fnamberino.github.io%2fposts%2f2025%2f05%2fiot-security-analysis-d-link-dir-820l-router%2f;title=IoT%20Security%20Analysis%3a%20D-Link%20DIR-820L%20Router" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=IoT%20Security%20Analysis%3a%20D-Link%20DIR-820L%20Router%20https%3a%2f%2fnamberino.github.io%2fposts%2f2025%2f05%2fiot-security-analysis-d-link-dir-820l-router%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fnamberino.github.io%2fposts%2f2025%2f05%2fiot-security-analysis-d-link-dir-820l-router%2f&amp;t=IoT%20Security%20Analysis%3a%20D-Link%20DIR-820L%20Router" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=IoT%20Security%20Analysis%3a%20D-Link%20DIR-820L%20Router&amp;url=https%3a%2f%2fnamberino.github.io%2fposts%2f2025%2f05%2fiot-security-analysis-d-link-dir-820l-router%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>

    
    <div class="pagination">
        

        <div class="pagination__buttons">
            

            
            <span class="button next">
                <a href="https://namberino.github.io/posts/2025/02/the-lorenz-system-and-the-butterfly-effect/">
                    <span class="button__text">The Lorenz System and The Butterfly Effect</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>


    

    

    

  </main>

            </div>

            
                <footer class="footer">
    
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.e89fda0f29b95d33f6f4224dd9e5cf69d84aff3818be2b0d73e731689cc374261b016d17d46f8381962fb4a1577ba3017b1f23509d894f6e66431f988c00889e.js" integrity="sha512-6J/aDym5XTP29CJN2eXPadhK/zgYvisNc&#43;cxaJzDdCYbAW0X1G&#43;DgZYvtKFXe6MBex8jUJ2JT25mQx&#43;YjACIng=="></script>




    </body>
</html>
